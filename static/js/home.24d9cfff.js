(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["home"],{2533:function(t,e,n){"use strict";var i=n("fbb3"),o=n.n(i);o.a},"4adf":function(t,e,n){"use strict";var i=n("c0ab"),o=n.n(i);o.a},bb51:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",[n("NewTransactionForm",{staticClass:"mb-4"}),n("TransactionList",{attrs:{transactions:t.transactions,pageBottom:!1}})],1)},o=[],a=(n("2ca0"),n("2909")),s=n("5530"),r=n("2f62"),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-row",{attrs:{dense:""}},[n("v-col",{attrs:{cols:"12"}},[n("v-form",{ref:"numberForm",staticClass:"mb-4",attrs:{"lazy-validation":""},model:{value:t.isNumberValid,callback:function(e){t.isNumberValid=e},expression:"isNumberValid"}},[n("v-text-field",{ref:"number",attrs:{"append-icon":"mdi-send",label:"Phone Number",hint:"Enter 10 digit number",color:"primary",prefix:"+63",type:"number",maxlength:"10",counter:"",clearable:"",loading:t.numberInputLoading,"error-messages":t.numberErrors,disabled:t.numberInputDisabled},on:{"click:clear":t.onClearNumber,focus:t.onClearErrors,"click:append":t.onValidatenumber},model:{value:t.number,callback:function(e){t.number=e},expression:"number"}})],1),n("v-snackbar",{attrs:{timeout:"-1"},scopedSlots:t._u([{key:"action",fn:function(e){var i=e.attrs;return[n("v-btn",t._b({attrs:{color:"pink",text:""},on:{click:function(e){t.snackbar=!1}}},"v-btn",i,!1),[t._v("Close")])]}}]),model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v(" "+t._s(t.snackbarText)+" ")]),n("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},model:{value:t.selectProductDialog,callback:function(e){t.selectProductDialog=e},expression:"selectProductDialog"}},[n("v-card",[n("v-toolbar",{attrs:{color:"#2a9d8f",dark:""}},[n("v-toolbar-title",[t._v("Select Product")]),n("v-spacer"),n("v-btn",{attrs:{icon:"",dark:""},on:{click:t.onCloseProductSelect}},[n("v-icon",[t._v("mdi-close")])],1)],1),t.paymentOutlet?n("div",{staticClass:"pa-4"},[n("v-img",{attrs:{"max-height":"70",src:t.paymentOutlet.logoUrl,contain:""}}),n("v-form",{ref:"categorySelectForm"},[n("v-select",{staticClass:"text-uppercase",attrs:{label:"Product Category",hint:"Select product category","persistent-hint":"",items:t.paymentOutlet.productCategories},model:{value:t.category,callback:function(e){t.category=e},expression:"category"}}),t.paymentOutlet.customAmountAllowed&&"Regular"===t.category?n("v-text-field",{attrs:{type:"number",label:"Amount","append-icon":"mdi-send",rules:t.customAmountRules,hint:t.customAmountHint},on:{"click:append":function(e){return t.onProductSelect("0")}},model:{value:t.customAmount,callback:function(e){t.customAmount=e},expression:"customAmount"}}):t._e()],1),t.products?n("v-list",{attrs:{id:"product-list","max-height":"60vh","two-line":""}},t._l(t.products,(function(e){return n("v-list-item",{key:e.id,attrs:{color:"grey darken-1",dense:""},on:{click:function(n){return t.onProductSelect(e.id)}}},[n("v-list-item-content",[n("v-list-item-title",{staticClass:"title",domProps:{textContent:t._s(e.productCode)}}),n("v-list-item-subtitle",{domProps:{textContent:t._s(e.description)}})],1),n("v-list-item-action",[n("v-btn",{attrs:{icon:""},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.onShowTooltip(e)}}},[n("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("mdi-information")])],1)],1)],1)})),1):t._e(),t.product?n("v-dialog",{model:{value:t.confirmDialog,callback:function(e){t.confirmDialog=e},expression:"confirmDialog"}},[n("v-card",{attrs:{loading:t.confirmCardLoading,"max-length":"300"}},[n("v-img",{staticClass:"align-end",attrs:{"max-height":"150px",src:t.paymentOutlet.logoUrl,contain:""}}),n("v-card-title",[n("v-spacer"),n("span",{staticClass:"headline"},[t._v("+63"+t._s(t.number))])],1),n("v-card-subtitle",{staticClass:"text-right"},[t._v(t._s(t.product.productCode))]),t.orderConfiremed?n("v-card-text",[n("span",{staticClass:"text-h4"},[t._v("Success!")]),n("v-icon",[t._v("check-circle-outline")]),n("br"),t._v("Thank you for using "),n("span",{staticClass:"font-weight-light"},[t._v("Load")]),n("span",{staticClass:"font-weight-bold"},[t._v("Ninja")]),t._v(". You will receive notification shortly. ")],1):n("v-card-text",[t._v(t._s(t.product.name)+". "+t._s(t.product.description))]),t.orderConfiremed?n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:t.onTransactionDone}},[t._v("Done")])],1):n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"grey darken-1",text:""},on:{click:function(e){t.confirmDialog=!1}}},[t._v("Cancel")]),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:t.onConfirmBuy}},[t._v("Confirm")])],1)],1),n("v-card")],1):t._e()],1):t._e()],1)],1)],1)],1)},u=[],l=(n("99af"),n("4de4"),n("7db0"),n("b0c0"),n("d3b7"),n("779d")),m={name:"NewTransactionForm",data:function(){return{isNumberValid:!1,number:"",numberInputLoading:!1,numberInputDisabled:!1,numberErrors:[],snackbar:!1,snackbarText:"",selectProductDialog:!1,category:null,paymentOutlet:null,product:null,customAmount:null,confirmDialog:!1,confirmCardLoading:!1,orderConfiremed:!1}},computed:{products:function(){var t=this;return this.paymentOutlet.products?this.paymentOutlet.products.filter((function(e){return e.category==t.category})):null},numberFormatted:function(){return this.number?"+63".concat(this.number):null},customAmountRules:function(){var t=this,e=[],n=function(e){return t.customAmountLimit.minimum<=e&&e<=t.customAmountLimit.maximum||"Invalid amount range"};return e.push(n),e},customAmountLimit:function(){return this.paymentOutlet.customAmountAllowed?this.paymentOutlet.amountLimits.find((function(t){return"PHP"===t.currency})):null},customAmountHint:function(){return this.paymentOutlet.customAmountAllowed?"Enter custom amount [".concat(this.customAmountLimit.minimum," - ").concat(this.customAmountLimit.maximum,"]"):""}},methods:{onValidatenumber:function(){var t=this;if(this.numberErrors=[],this.number){if(this.number.startsWith("9")||this.numberErrors.push("Input should start with 9"),10!==this.number.length&&this.numberErrors.push("Input should be 10 digit length"),!this.numberErrors.length){this.setNumberInputLoading(!0);var e={phone_number:this.numberFormatted};this.$http.get("/cphapp/api/buy-product/",{params:e}).then((function(e){setTimeout((function(){t.paymentOutlet=new l["b"](e.data),t.setNumberInputLoading(!1),t.selectProductDialog=!0}),2e3)})).catch((function(e){t.setNumberInputLoading(!1),e.response?400===e.response.status?t.numberErrors=Object(a["a"])(e.response.data):401===e.response.status||500===e.response.status&&(t.numberErrors.push("Something went wrong"),t.snackbarText=e.response.statusText+". Please try again later.",t.snackbar=!0):e.request}))}}else this.numberErrors.push("Please enter phone number")},setNumberInputLoading:function(t){this.numberInputLoading=t,this.numberInputDisabled=t},onClearNumber:function(){this.$refs.numberForm.resetValidation(),this.onClearErrors(),this.dataReset()},onClearErrors:function(){this.snackbar=!1,this.snackbarText="",this.numberErrors=[]},onShowTooltip:function(){},onProductSelect:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if("0"===t){if(!this.$refs.categorySelectForm.validate())return;var e={amount:this.customAmount,outletId:this.paymentOutlet.id,currency:"PHP"};this.product=new l["c"](e,this.paymentOutlet.id,this.paymentOutlet.name)}else this.product=this.products.find((function(e){return e.id===t}));this.confirmDialog=!0},onConfirmBuy:function(){var t=this;this.confirmCardLoading="primary";var e="/cphapp/api/transactions/",n=Object(s["a"])(Object(s["a"])({},this.product.required),{},{phone_number:this.numberFormatted});this.$http.post(e,n).then((function(e){t.orderConfiremed=!0})).catch((function(t){})).finally((function(){return t.confirmCardLoading=!1}))},onCloseProductSelect:function(){this.selectProductDialog=!1,this.dataReset()},onTransactionDone:function(){this.dataReset()},dataReset:function(){Object.assign(this.$data,this.$options.data())}}},d=m,h=(n("4adf"),n("2877")),p=n("6544"),f=n.n(p),b=n("8336"),v=n("b0af"),g=n("99d9"),k=n("62ad"),y=n("169a"),C=n("4bd4"),_=n("132d"),x=n("adda"),T=n("8860"),O=n("da13"),w=n("1800"),V=n("5d23"),A=n("0fd9"),L=n("b974"),P=(n("caad"),n("a9e3"),n("ade3")),D=(n("ca71"),n("8dd9")),S=n("a9ad"),j=n("7560"),E=n("f2e7"),I=n("fe6c"),N=n("58df"),B=n("80d2"),$=n("d9bd"),F=Object(N["a"])(D["a"],S["a"],E["a"],Object(I["b"])(["absolute","bottom","left","right","top"])).extend({name:"v-snackbar",props:{app:Boolean,centered:Boolean,contentClass:{type:String,default:""},multiLine:Boolean,text:Boolean,timeout:{type:[Number,String],default:5e3},transition:{type:[Boolean,String],default:"v-snack-transition",validator:function(t){return"string"===typeof t||!1===t}},vertical:Boolean},data:function(){return{activeTimeout:-1}},computed:{classes:function(){return{"v-snack--absolute":this.absolute,"v-snack--active":this.isActive,"v-snack--bottom":this.bottom||!this.top,"v-snack--centered":this.centered,"v-snack--has-background":this.hasBackground,"v-snack--left":this.left,"v-snack--multi-line":this.multiLine&&!this.vertical,"v-snack--right":this.right,"v-snack--text":this.text,"v-snack--top":this.top,"v-snack--vertical":this.vertical}},hasBackground:function(){return!this.text&&!this.outlined},isDark:function(){return this.hasBackground?!this.light:j["a"].options.computed.isDark.call(this)},styles:function(){if(this.absolute)return{};var t=this.$vuetify.application,e=t.bar,n=t.bottom,i=t.footer,o=t.insetFooter,a=t.left,s=t.right,r=t.top;return{paddingBottom:Object(B["f"])(n+i+o),paddingLeft:this.app?Object(B["f"])(a):void 0,paddingRight:this.app?Object(B["f"])(s):void 0,paddingTop:Object(B["f"])(e+r)}}},watch:{isActive:"setTimeout",timeout:"setTimeout"},mounted:function(){this.isActive&&this.setTimeout()},created:function(){this.$attrs.hasOwnProperty("auto-height")&&Object($["e"])("auto-height",this),0==this.timeout&&Object($["d"])('timeout="0"',"-1",this)},methods:{genActions:function(){return this.$createElement("div",{staticClass:"v-snack__action "},[Object(B["o"])(this,"action",{attrs:{class:"v-snack__btn"}})])},genContent:function(){return this.$createElement("div",{staticClass:"v-snack__content",class:Object(P["a"])({},this.contentClass,!0),attrs:{role:"status","aria-live":"polite"}},[Object(B["o"])(this)])},genWrapper:function(){var t=this.hasBackground?this.setBackgroundColor:this.setTextColor,e=t(this.color,{staticClass:"v-snack__wrapper",class:D["a"].options.computed.classes.call(this),directives:[{name:"show",value:this.isActive}]});return this.$createElement("div",e,[this.genContent(),this.genActions()])},genTransition:function(){return this.$createElement("transition",{props:{name:this.transition}},[this.genWrapper()])},setTimeout:function(){var t=this;window.clearTimeout(this.activeTimeout);var e=Number(this.timeout);this.isActive&&![0,-1].includes(e)&&(this.activeTimeout=window.setTimeout((function(){t.isActive=!1}),e))}},render:function(t){return t("div",{staticClass:"v-snack",class:this.classes,style:this.styles},[!1!==this.transition?this.genTransition():this.genWrapper()])}}),R=n("2fa4"),W=n("8654"),q=n("71d9"),H=n("2a7f"),J=Object(h["a"])(d,c,u,!1,null,"3f152065",null),M=J.exports;f()(J,{VBtn:b["a"],VCard:v["a"],VCardActions:g["a"],VCardSubtitle:g["b"],VCardText:g["c"],VCardTitle:g["d"],VCol:k["a"],VDialog:y["a"],VForm:C["a"],VIcon:_["a"],VImg:x["a"],VList:T["a"],VListItem:O["a"],VListItemAction:w["a"],VListItemContent:V["a"],VListItemSubtitle:V["b"],VListItemTitle:V["c"],VRow:A["a"],VSelect:L["a"],VSnackbar:F,VSpacer:R["a"],VTextField:W["a"],VToolbar:q["a"],VToolbarTitle:H["a"]});var U=n("4bf4"),z={name:"Home",components:{TransactionList:U["a"],NewTransactionForm:M},data:function(){return{isNumberValid:!1,phoneNumber:"",phoneNumberErrors:[],rules:{required:function(t){return!!t||"Required."},isvalid:function(t){return 11==t.length&&t.startsWith("0")||"Phone number is invalid"}},loading:!1,e1:1,loadOffset:0,transactions:[],newTransactionDialog:!1}},computed:Object(s["a"])(Object(s["a"])({},Object(r["b"])(["pageBottom"])),{},{phoneNumberRules:function(){var t=[],e=function(t){return!!t||"Phone number is required"},n=function(t){return 11==t.length&&t.startsWith("0")||"Phone number is invalid"};return t.push(e,n),t}}),watch:{pageBottom:function(t){t&&this.onLoadMore()}},methods:{fetchTransactions:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{limit:10,offset:0},n="/cphapp/api/transactions/";this.$http.get(n,{params:e}).then((function(e){var n;(n=t.transactions).push.apply(n,Object(a["a"])(e.data.results))})).catch((function(t){}))},onLoadMore:function(){this.fetchTransactions({limit:10,offset:this.loadOffset}),this.loadOffset+=10},onShowActions:function(){},onCloseTransactionForm:function(){this.newTransactionDialog=!1},onScroll:function(){}},created:function(){this.transactions.length||(this.fetchTransactions(),this.loadOffset+=10)}},Y=z,G=(n("2533"),n("a523")),K=Object(h["a"])(Y,i,o,!1,null,"df42996c",null);e["default"]=K.exports;f()(K,{VContainer:G["a"]})},c0ab:function(t,e,n){},ca71:function(t,e,n){},fbb3:function(t,e,n){}}]);
//# sourceMappingURL=home.24d9cfff.js.map